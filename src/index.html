<!doctype html>
<html>
  <head>
    <title><%= json.project.title %></title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <link rel="stylesheet" type="text/css" href="style.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
    <%= t.include("partials/_adHead.html") %>
    <style>[ng-cloak] { display: none; }</style>
  </head>
  <body ng-app="brackets">

    <%= t.include("partials/_dfHeader.html") %>

    <header>
        <div class="image"><img src="assets/dogride.JPG"></div>
        <div class="image"><img src="assets/gardens.JPG"></div>
        <div class="image"><img src="assets/myrtle.JPG"></div>
    </header>

    <main class="bracket" ng-controller="bracket-controller" ng-cloak>
    
      <nav class="list-pane">
        <div class="round-selection">
          <a class="shift-round" ng-click="shiftRound(-1)"><i class="fa fa-chevron-circle-left"></i></a>
          <h1>{{round.title}}</h1>
          <a class="shift-round" ng-click="shiftRound(1)"><i class="fa fa-chevron-circle-right"></i></a>
        </div>
        <ul class="round">
          <li
            ng-repeat="match in round.matchups"
            ng-class="{ voted: match.voted, selected: match == selected.match }"
            class="matchup"
          >
              <div 
                ng-repeat="candidate in match.options"
                ng-class="{
                  won: match.winner == candidate.id,
                  chosen: candidate.id == match.voted
                }"
                class="card {{$first ? 'top' : 'bottom'}}"
                ng-click="selectMatch(match, candidate)"
              >
                  <div class="icons">
                    <i class="fa fa-star win-marker" ng-if="match.winner == candidate.id"></i>
                    <i class="fa fa-check vote-marker" ng-if="match.voted == candidate.id"></i>
                    <i class="fa fa-spinner fa-spin voting-marker" ng-if="candidate.voting"></i>
                    <a
                      ng-if="round.current && !match.voted && !candidate.voting"
                      ng-click="vote(candidate, match)"
                      class="vote button"
                    ><i class="fa fa-check-square vote-link"></i></a>
                  </div>
                {{ candidate.details.name }} - {{ candidate.details.title }}
                  <div class="result">
                    Chosen by {{ candidate.votes / (match.total || 1) * 100 | number:1 }}% of voters
                  </div>
              </div>
          </li>
        </ul>
      </nav>

      <section class="detail-pane">
        <div class="match-details">
          <div class="candidate"
            ng-repeat="candidate in selected.match.options"
            ng-class="{ focus: candidate == selected.candidate }"
          >
            <a class="close" ng-click="clearCandidate()">
              <i class="fa fa-times-circle"></i>
            </a>
            <h1>{{candidate.details.name}}</h1>
            <p class="chatter">{{candidate.details.description}}</p>
          </div>
        </div>
      </section>

    </main>

    <footer>
      <img class="logo" src="assets/seattletimes.svg">
    </footer>

    <script>
window.bracket = <%= JSON.stringify(grunt.data.bracket) %>;
window.config = {
  sheet: "<%= json.project.sheets[0] %>",
  endpoint: "<%= json.project.endpoint %>",
  page: "<%= json.package.name %>"
};
    </script>

    <script src="app.js"></script>
    <% if (json.project.production) { %>
    <%= !json.project.embedded ? t.include("partials/_adFoot.html") : "" %>
    <%= t.include("partials/_workHere.html") %>
    <% } %>
  </body>
</html>
